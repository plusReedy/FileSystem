<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FileSystem - by plusReedy</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .search-bar {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .search-bar input:focus {
            outline: none;
            border-color: #667eea;
        }

        .breadcrumb {
            padding: 15px 30px;
            background: #f1f3f5;
            font-size: 14px;
            color: #495057;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            margin: 0 5px;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content {
            padding: 30px;
        }

        .folder-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .folder-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            text-align: center;
        }

        .folder-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .folder-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .folder-card h3 {
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .folder-card p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .file-list {
            display: grid;
            gap: 10px;
        }

        .file-item {
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .file-item:hover {
            background: #e9ecef;
        }

        .file-name {
            font-weight: 500;
            color: #212529;
        }

        .file-badge {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 10px;
        }

        .download-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }

        .download-btn:hover {
            background: #764ba2;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 20px;
            transition: background 0.3s;
        }

        .back-btn:hover {
            background: #5a6268;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìÇ File System</h1>
            <p>Browse and download.</p>
        </header>

        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="üîç Search for files...">
        </div>

        <div class="breadcrumb" id="breadcrumb">
            <a href="#" onclick="navigateToRoot()">Home</a>
        </div>

        <div class="content">
            <button class="back-btn" id="backBtn" style="display: none;" onclick="navigateBack()">‚Üê Back</button>
            <div id="content"></div>
        </div>
    </div>

    <script>
        const GITHUB_USER = 'plusReedy';
        const GITHUB_REPO = 'FileSystem';
        const GITHUB_BRANCH = 'main'; 
        
        let currentPath = '';
        let pathHistory = [];
        let allFiles = [];

        async function fetchFolderContents(path = '') {
            const apiUrl = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${path}`;
            
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Error fetching folder contents:', error);
                return [];
            }
        }

        function renderFolders(items) {
            const folders = items.filter(item => item.type === 'dir');
            const files = items.filter(item => item.type === 'file' && (item.name.toLowerCase().endsWith('.pk8') || item.name.toLowerCase().endsWith('.pk9')));

            let html = '';

            if (folders.length > 0) {
                html += '<div class="folder-grid">';
                folders.forEach(folder => {
                    html += `
                        <div class="folder-card" onclick="navigateToFolder('${folder.path}', '${folder.name}')">
                            <div class="folder-icon">üìÅ</div>
                            <h3>${folder.name}</h3>
                            <p>Click to open</p>
                        </div>
                    `;
                });
                html += '</div>';
            }

            if (files.length > 0) {
                html += '<div class="file-list">';
                files.forEach(file => {
                    const extension = file.name.split('.').pop().toLowerCase();
                    const badge = extension === 'pk8' ? 'SWSH' : 'SCVI';
                    html += `
                        <div class="file-item">
                            <div>
                                <span class="file-name">${file.name}</span>
                                <span class="file-badge">${badge}</span>
                            </div>
                            <button class="download-btn" onclick="downloadFile('${file.download_url}', '${file.name}')">
                                Download
                            </button>
                        </div>
                    `;
                });
                html += '</div>';
            }}

            if (folders.length === 0 && files.length === 0) {
                html = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìÇ</div>
                        <h2>No files found</h2>
                        <p>This folder appears to be empty.</p>
                    </div>
                `;
            }

            document.getElementById('content').innerHTML = html;
        }

        async function navigateToFolder(path, name) {
            pathHistory.push({path: currentPath, name: name});
            currentPath = path;
            
            updateBreadcrumb();
            document.getElementById('backBtn').style.display = 'block';
            
            const contents = await fetchFolderContents(path);
            renderFolders(contents);
        }

        function navigateBack() {
            if (pathHistory.length === 0) {
                navigateToRoot();
                return;
            }

            const previous = pathHistory.pop();
            currentPath = previous.path;
            
            if (pathHistory.length === 0) {
                document.getElementById('backBtn').style.display = 'none';
            }
            
            updateBreadcrumb();
            loadCurrentFolder();
        }

        function navigateToRoot() {
            currentPath = '';
            pathHistory = [];
            document.getElementById('backBtn').style.display = 'none';
            updateBreadcrumb();
            loadCurrentFolder();
        }

        function updateBreadcrumb() {
            let breadcrumbHtml = '<a href="#" onclick="navigateToRoot()">Home</a>';
            
            pathHistory.forEach((item, index) => {
                breadcrumbHtml += ` / <a href="#" onclick="navigateToPath(${index})">${item.name}</a>`;
            });
            
            if (currentPath) {
                const currentName = currentPath.split('/').pop();
                breadcrumbHtml += ` / <span>${currentName}</span>`;
            }
            
            document.getElementById('breadcrumb').innerHTML = breadcrumbHtml;
        }

        function navigateToPath(index) {
            pathHistory = pathHistory.slice(0, index + 1);
            const target = pathHistory.pop();
            currentPath = target.path;
            updateBreadcrumb();
            loadCurrentFolder();
        }

        async function loadCurrentFolder() {
            const contents = await fetchFolderContents(currentPath);
            renderFolders(contents);
        }

        function downloadFile(url, filename) {
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        document.getElementById('searchInput').addEventListener('input', async (e) => {
            const searchTerm = e.target.value.toLowerCase();
            
            if (searchTerm.length === 0) {
                loadCurrentFolder();
                return;
            }

            const contents = await fetchFolderContents(currentPath);
            const filtered = contents.filter(item => 
                item.name.toLowerCase().includes(searchTerm)
            );
            renderFolders(filtered);
        });

        loadCurrentFolder();
    </script>
</body>
</html>
